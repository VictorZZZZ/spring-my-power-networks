<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Абоненты</title>
    <link rel="stylesheet" th:href="@{/css/bootstrap.css}">
    <link th:href="@{/css/assets/global/css/components-md.min.css}" rel="stylesheet" id="style_components" type="text/css" />
</head>
<body>
<div class="container">
    <div th:replace="~{navigation :: navigation(Home)}" />
    <div th:replace="~{flashMessages :: flash}" />

<!-- todo Pagination -->
    <h1>Подготовка отправки СМС</h1>
    <div class="container">
        <form action="#" th:action="@{/cart/createOrder}" th:object="${order}" method="post" th:if="${cartItems.size()>0}"
              onsubmit="return confirm('Вы действительно хотите отправить эту рассылку СМС?');">
            <div class="form-row">
                <div class="form-group col-md-6">
                    <label>Сообщение СМС</label>
                    <textarea class="form-control" th:field="*{message}" replace="Текст сообщения"></textarea>
                </div>
                <div class="form-group col-md-2">
                    <a class="btn btn-outline-dark" href="#" title="Добавить из шаблона" style="margin-top: 32px;">
                        Шаблон
                    </a>
                </div>
            </div>
            <div class="form-group col-md-12">
                <input class="btn btn-outline-info" type="submit" value="Отправить SMS" />
            </div>
        </form>
        <div class="row">
            <p>Всего в рассылке <span th:text="${cartItems.size()}"/> абонентов</p>
            <table class="table table-hover" th:if="${cartItems.size()>0}">
                <thead class="thead-dark">
                <th> ТП </th>
                <th> Фидер </th>
                <th> Лиц. Сч. </th>
                <th> ФИО </th>
                <th> Номера тел. </th>
                <th> Отметки </th>
                <th> Создан </th>
                <th> Изменен </th>
                <th> Действия </th>
                </thead>
                <tbody>
                    <tr th:each="item:${cartItems}">
                        <td th:text="${item.abonent.fider.tp.name}"/>
                        <td th:text="${item.abonent.fider.name}"/>
                        <td th:text="${item.abonent.accountNumber}"/>
                        <td th:text="${item.abonent.surname +' '+ item.abonent.name +' '+ item.abonent.middlename}"/>
                        <td th:object="${item.abonent}">
                            <span th:text="*{homePhone+ ' ' + firstPhone + ' ' + secondPhone }" /><br/>
                        </td>
                        <td th:object="${item.abonent}">
                            <span th:text="*{notes}" /><br/>
                        </td>
                        <td>
                            <span th:text="${#dates.format(item.abonent.created, 'dd.MM.yyyy HH:mm')}" /><br/>
                        </td>
                        <td>
                            <span th:text="${#dates.format(item.abonent.modified, 'dd.MM.yyyy HH:mm')}" /><br/>
                        </td>
                        <td>
                            <a class="btn btn-outline-danger" th:href="@{'/cart/removeFromCart/' + ${item.abonent.accountNumber}}">Удалить из рассылки</a>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

    </div>


<script th:src="@{/js/jquery.js}"></script>
<script th:src="@{/js/bootstrap.bundle.js}"></script>
</body>
</html>